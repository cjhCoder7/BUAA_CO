## P1 è¯¾ä¸‹æ„Ÿæƒ³â˜¹ï¸

å’ŒP0ä¸å¤ªä¸€æ ·ï¼Œè¿™æ¬¡çš„P1æ˜¯å…­é“é¢˜ï¼Œå…¶ä¸­ä¸€é“æ˜¯é™„åŠ é¢˜ï¼Œå› ä¸ºå›½åº†èŠ‚çš„åŸå› ï¼ŒP1çš„æ—¶é—´æ˜¯ä¸¤å‘¨ï¼Œæ‰€ä»¥åœ¨åé¢å¼€æ”¾äº†`ç»Ÿè®¡å›¾`æ¨¡å—ï¼Œé‡Œé¢ä¼šæœ‰åœ¨çº¿å­¦ä¹ çš„å‚ä¸æƒ…å†µï¼ŒåŒæ—¶ä¼šæœ‰ä¸€äº›æ¨èç»ƒä¹ é¢˜~ï¼ˆè™½ç„¶æˆ‘ä¸€é“éƒ½æ²¡åšï¼Œè€Œä¸”è¿˜æ˜¯åœ¨è€ƒè¯•å½“å¤©ä¸‹åˆæ‰å‘ç°çš„ğŸ˜‚ï¼‰

### çŠ¶æ€æœºå†™æ³•ğŸ«¡

è¿™é‡Œä¸»è¦æ€»ç»“ä¸€ä¸‹`verilog`å†™çŠ¶æ€æœºçš„å†™æ³•

```verilog
reg[1: 0] state, next_state;

parameter s0 = ......;
parameter s1 = ......;

//æ—¶é’Ÿæ²¿ä¸Šå‡ï¼ŒçŠ¶æ€è½¬ç§»ï¼ŒåŒæ­¥å¤ä½
always@(posedge clk) begin
    if (reset) begin
        state <= 2'b0;
    end else begin
        state <= next_state;
    end
end

//æ—¶é’Ÿæ²¿ä¸Šå‡ï¼ŒçŠ¶æ€è½¬ç§»ï¼Œå¼‚æ­¥å¤ä½
always@(posedge clk, negedge reset) begin
    if (reset) begin
        state <= 2'b0;
    end else begin
        state <= next_state;
    end
end

//è®¡ç®—æ¬¡æ€next_state
always@(*) begin
    ......

    case(state)
        s0: begin
            //çŠ¶æ€è½¬ç§»
        end
        s1: begin
            //çŠ¶æ€è½¬ç§»
        end
        ......
    endcase
end

//è¾“å‡ºé€»è¾‘æ–¹æ¡ˆ1
always@(*) begin
    out = ......
    //outéœ€è¦æ˜¯regç±»å‹çš„
end

//è¾“å‡ºé€»è¾‘æ–¹æ¡ˆ2
assign out = ......
```

### ç®—æœ¯å³ç§»ã€é€»è¾‘å³ç§»ğŸ«¡

ç®—æ•°å³ç§»éœ€è¦åœ¨**å·¦æ“ä½œæ•°**ä½¿ç”¨åˆ°`$signed()`ï¼Œå¦åˆ™è¿˜æ˜¯ä¸ºé€»è¾‘å³ç§»

### å‡½æ•°çš„ä½¿ç”¨ğŸ«¡

```verilog
function [7:0] toLower(
    input [7:0] in;
)
    if(in >= "A" && in <= "Z") toLower = in + "a" - "A";
    else toLower = in;
endfunction

// ç›´æ¥ä½¿ç”¨å°±æ˜¯äº†
toLower(in)
```

### `testbench`æ¼‚äº®å†™æ³•ğŸ«¡

> æ¥æºï¼šğŸ¥°
>
>  https://flyinglandlord.github.io/2021/10/24/BUAA-CO-2021/P1/P1%E8%AF%BE%E4%B8%8B%E5%AD%A6%E4%B9%A0/ ğŸ˜œ

```verilog
	always #1 clk = ~clk;
	initial begin
		// Initialize Inputs
		clk = 0;
		reset = 1;
		in = 0;
		data = "begin enDbegin xyzz eNd BeGin begin end endbegin end ";
		while(!data[0:7]) data = data << 8;
		#2;
		reset = 0;
         while(data[0: 7]) begin
			in[7:0] = data[0:7];
			data = data << 8;
			#2;
		end
		$finish;
	end
```

### ä½æ‹¼æ¥è¿ç®—ç¬¦ğŸ«¡

æ³¨æ„**å¤§æ‹¬å·**çš„ä½ç½®

```verilog
assign ext = {imm, {16{1'b0}}};
```

## P1 è¯¾ä¸Šæµ‹è¯•æ„Ÿæƒ³ğŸ˜‡

æœ‰ä¸€è¯´ä¸€ï¼Œæˆ‘å‰å‡ å¤©è¿˜åœ¨è¯´ä»Šå¹´çš„P0æ¯”å»å¹´ç®€å•å¤šäº†ï¼Œç»“æœP1ç»™æˆ‘æ‹‰äº†ä¸€å¨å¤§çš„ï¼( ğŸ˜

å‰ä¸¤é“é¢˜è¿˜å¥½ï¼Œä¾ç„¶æ˜¯ååˆ†è¿…é€Ÿçš„å°±åšå‡ºæ¥äº†ï¼Œæ¥ç€æˆ‘åœ¨å…«ç‚¹äºŒåå·¦å³å¼€å§‹å†™ç¬¬ä¸‰é“é¢˜ï¼Œåˆ°äº†ä¹ç‚¹é’Ÿï¼Œæœ¬æ¥æˆ‘æ˜¯æ‰“ç®—äº¤å·èµ°äººäº†çš„ï¼Œç„¶ååŠ©æ•™èµ°è¿‡æ¥ç»™äº†æˆ‘å¸Œæœ›~ğŸ˜­

ä»–è®©æˆ‘æ¥ç€å†åšä¸€ä¼šï¼Œå–æ¶ˆäº†æˆ‘çš„äº¤å·ï¼Œè¿™ä¸€ä¼šå°±æ˜¯ä¸€ä¸ªå°æ—¶å•Šï¼Œæˆ‘åˆåšåˆ°åç‚¹é’Ÿï¼Œç»“æœè¿˜æ˜¯æ²¡åšå‡ºæ¥ï¼Œä¸€ä¸ªæµ‹è¯•ç‚¹éƒ½æ²¡æœ‰é€šè¿‡ï¼ŒçœŸçš„è¦ç¬‘æ­»äº†ï¼Œç™½ç™½æµªè´¹ä¸€ä¸ªå°æ—¶çš„ä¼‘æ¯æ—¶é—´ğŸ¤¡ğŸ¤¡ğŸ¤¡ğŸ¤¡ğŸ¤¡ğŸ¤¡ğŸ¤¡ğŸ¤¡ğŸ¤¡ğŸ¤¡

è€Œä¸”ä¸­é€”è¿˜é‡åˆ°äº†**ISEæ— æ³•ä»¿çœŸçš„é—®é¢˜**ï¼Œæœ€ååˆé‡æ–°æ–°å»ºäº†ä¸€ä¸ªå·¥ç¨‹æ‰è§£å†³

è™½ç„¶åšå‡ºæ¥ä¸¤é“é¢˜ï¼Œè¿˜æ˜¯ç®—é€šè¿‡ï¼Œä¸è¿‡ä¸èƒ½å¤Ÿä¼˜ç§€äº†å•Šï¼Œçƒ¦çƒ¦çƒ¦~ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©ğŸ˜©

![](image/1.png)
